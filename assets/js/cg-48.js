(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{340:function(t,s,a){"use strict";a.r(s);var n=a(7),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"é¢ç»æ‰‹å†Œ-Â·-ç¬¬19ç¯‡ã€Šthread-start-å®ƒæ˜¯æ€ä¹ˆè®©çº¿ç¨‹å¯åŠ¨çš„å‘¢-ã€‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#é¢ç»æ‰‹å†Œ-Â·-ç¬¬19ç¯‡ã€Šthread-start-å®ƒæ˜¯æ€ä¹ˆè®©çº¿ç¨‹å¯åŠ¨çš„å‘¢-ã€‹"}},[t._v("#")]),t._v(" é¢ç»æ‰‹å†Œ Â· ç¬¬19ç¯‡ã€ŠThread.start() ï¼Œå®ƒæ˜¯æ€ä¹ˆè®©çº¿ç¨‹å¯åŠ¨çš„å‘¢ï¼Ÿã€‹")]),t._v(" "),s("p",[t._v("ä½œè€…ï¼šå°å‚…å“¥\n"),s("br"),t._v("åšå®¢ï¼š"),s("a",{attrs:{href:"https://bugstack.cn",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://bugstack.cn"),s("OutboundLink")],1)]),t._v(" "),s("blockquote",[s("p",[t._v("æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼ğŸ˜„")])]),t._v(" "),s("h2",{attrs:{id:"ä¸€ã€å‰è¨€"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¸€ã€å‰è¨€"}},[t._v("#")]),t._v(" ä¸€ã€å‰è¨€")]),t._v(" "),s("p",[s("code",[t._v("æœ‰å¥è¯ï¼šæ­£å› ä¸ºä½ ä¼˜ç§€ï¼Œæ‰€ä»¥éš¾ä»¥å“è¶Šï¼")])]),t._v(" "),s("p",[t._v("åˆšå¼€å§‹å¬è¿™å¥è¯è¿˜åœ¨ä¸Šå­¦ï¼Œæ—¢ä¸å“è¶Šã€ä¹Ÿä¸ä¼˜ç§€ï¼Œç”šè‡³å¯èƒ½è¿˜æœ‰ç‚¹ç¬¨ï¼ä½†çªç„¶ä»æŸæ¬¡çˆ¬åˆ°ç­çº§çš„å‰å‡ ååï¼Œå¼€å§‹å–œæ¬¢ä¸Šäº†è¿™ç§æ„Ÿè§‰ï¼ŒåŸæ¥å‰é¢çš„é£æ™¯æ˜¯å¦‚æ­¤ç¿çƒ‚ğŸ˜œï¼")]),t._v(" "),s("p",[t._v("ä¼˜ç§€å’Œå“è¶Šå·®çš„ä¸æ˜¯ä¸€ä¸ªç­‰çº§ï¼Œå½“ä½ æ„Ÿè§‰è‡ªå·±ä¼˜ç§€åï¼Œè¿˜èƒ½ä¿æŒç©ºç“¶çš„å¿ƒæ€å¼€å§‹ï¼Œæ‰èƒ½é€æ­¥çš„åƒå“è¶Šè¿ˆè¿›ï¼Œå¹¶æ¼«æ¼«é•¿ï¼")]),t._v(" "),s("p",[t._v("æ˜¯ä¸å°æ—¶å€™æ›´å®¹æ˜“å­¦ä¼šæ›´å¤šçš„çŸ¥è¯†ï¼Œä½†è¶Šå¤§è¶Šç¬¨äº†ï¼äººå¯èƒ½å¾ˆå®¹æ˜“è¢«è‡ªå·±çš„å¹´çºªå¤§äº†ï¼Œå½“æˆé•¿è€…ã€‚å´å¾ˆå°‘èƒ½ä¿æŒä¸€ä¸ªä½å§¿æ€è°¦å‘çš„å¿ƒæ€ï¼Œä¸æ–­çš„å­¦ä¹ ã€‚"),s("code",[t._v("æ‰€ä»¥æœ€å")]),t._v("ï¼Œæ”¾ä¸ä¸‹è‡ªå·±ï¼Œä¹Ÿæ‹¾ä¸èµ·èƒ½åŠ›ã€‚")]),t._v(" "),s("p",[t._v("å–œæ¬¢ä¸€å¥è¯ï¼Œ"),s("code",[t._v("è“æ˜¯å¤©çš„é¢œè‰²ã€çº¢æ˜¯ç«çš„è±¡å¾ï¼Œæˆ‘ä¸å­¦å¤§æµ·æŠ„è¢­å¤©çš„è“ã€ä¹Ÿä¸å­¦æ™šéœæ¨¡æ‹Ÿç«çš„çº¢ã€‚æˆ‘å°±æ˜¯æˆ‘ï¼Œç”Ÿå‘½æ˜¯æˆ‘çš„ã€å‘½è¿æ˜¯æˆ‘çš„")]),t._v("ã€‚"),s("strong",[t._v("å¥èº«ä¹Ÿæ˜¯ä½ çš„ã€å­¦ä¹ ä¹Ÿæ˜¯ä½ çš„")]),t._v("ï¼Œåªè¦ä½ æœ‰ä¸€ä¸ªå¥½å¿ƒæ€ï¼Œè‡ªç„¶ä¼šèµ°åˆ°å‰é¢å“è¶Šé‚£é‡Œï¼")]),t._v(" "),s("h2",{attrs:{id:"äºŒã€é¢è¯•é¢˜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#äºŒã€é¢è¯•é¢˜"}},[t._v("#")]),t._v(" äºŒã€é¢è¯•é¢˜")]),t._v(" "),s("p",[s("code",[t._v("è°¢é£æœºï¼Œå°è®°ï¼")]),t._v(" "),s("em",[t._v("ç å¾·")]),t._v("ï¼Œå¹´è½»äººå†™ä»£ç å¥½çŒ–ç‹‚ï¼Œä¸éµå®ˆè§„èŒƒè¿˜å–·æˆ‘ï¼Œä½ è¦"),s("code",[t._v("è€—å­å°¾æ±")]),t._v("ï¼è°¢é£æœºéª‚éª‚å’§å’§çš„ä¸‹ç­åï¼Œæ‰¾é¢è¯•å®˜èŠå¿ƒå¾—ã€‚")]),t._v(" "),s("p",[s("strong",[t._v("è°¢é£æœº")]),t._v("ï¼šæˆ‘æ„Ÿè§‰å¤©å¤©å°±åƒæ´»åœ¨ç²ªå †ï¼Œä»£ç éƒ½æ˜¯ä¹±ç³Ÿç³Ÿï¼Œæˆ‘æœ‰å¿ƒæ— åŠ›ï¼")]),t._v(" "),s("p",[s("strong",[t._v("é¢è¯•å®˜")]),t._v("ï¼šæ€ä¹ˆï¼Œæƒ³è·³æ§½äº†ï¼Ÿ")]),t._v(" "),s("p",[s("strong",[t._v("è°¢é£æœº")]),t._v("ï¼šæƒ³å»å†™ä»£ç æœ‰è§„èŒƒçš„å…¬å¸ï¼Œæƒ³æå‡ï¼")]),t._v(" "),s("p",[s("strong",[t._v("é¢è¯•å®˜")]),t._v("ï¼šå—¯ï¼ç¡®å®ï¼Œæœ‰äº›å¤§å…¬å¸çš„ä»£ç è´¨é‡è¦å¥½ä¸€äº›ã€‚ä½†æ˜¯ä½ ä¹Ÿè¦è‡ªèº«èƒ½åŠ›å¼ºçš„ã€‚")]),t._v(" "),s("p",[s("strong",[t._v("è°¢é£æœº")]),t._v("ï¼šæ˜¯çš„ï¼Œæˆ‘ä¸€ç›´åœ¨åŠªåŠ›å­¦ä¹ ï¼å‡†å¤‡è·‘è·¯ï¼")]),t._v(" "),s("p",[s("strong",[t._v("é¢è¯•å®˜")]),t._v("ï¼šé‚£æˆ‘é¡ºä¾¿è€ƒä½ ä¸ªé¢˜ï¼Œçœ‹çœ‹ä½ è¿›å¤§å‚çš„å‡ ç‡å¤§ä¸ã€‚"),s("code",[t._v("å—¯... Java çº¿ç¨‹å¦‚ä½•å¯åŠ¨çš„ï¼Ÿ")])]),t._v(" "),s("p",[s("strong",[t._v("è°¢é£æœº")]),t._v("ï¼šå¦‚ä½•å¯åŠ¨çš„ï¼Ÿ"),s("code",[t._v("start")]),t._v(" å¯åŠ¨çš„ï¼")]),t._v(" "),s("p",[s("strong",[t._v("é¢è¯•å®˜")]),t._v("ï¼šè¿˜æœ‰å—ï¼Ÿ")]),t._v(" "),s("p",[s("strong",[t._v("è°¢é£æœº")]),t._v("ï¼šå—¯...ï¼Œæ²¡äº†ï¼")]),t._v(" "),s("p",[s("strong",[t._v("é¢è¯•å®˜")]),t._v("ï¼šå—¯ï¼Œå¯èƒ½"),s("code",[t._v("ä¼šä¸ä¸ä¼š")]),t._v("è¿™ä¸€ä¸ªé¢˜å¹¶ä¸ä¼šè®©ä½ ä»£ç æœ‰å¤šç‰›ã€æœ‰å¤šå¥½ï¼Œä½†æ˜¯ä½ çš„æŠ€æœ¯æ ˆæ·±åº¦å’Œå¹¿åº¦ï¼Œå†³å®šä½ çš„ç¼–ç¨‹èŒä¸šç”Ÿæ¶¯æ˜¯å¦æœ‰ä¸€æ¡åº·åº„å¤§é“ã€‚è¿˜æ˜¯è¦å¤šåŠªåŠ›ï¼")]),t._v(" "),s("h2",{attrs:{id:"ä¸‰ã€çº¿ç¨‹å¯åŠ¨åˆ†æ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¸‰ã€çº¿ç¨‹å¯åŠ¨åˆ†æ"}},[t._v("#")]),t._v(" ä¸‰ã€çº¿ç¨‹å¯åŠ¨åˆ†æ")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// todo")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("p",[s("strong",[t._v("å’³å’³")]),t._v("ï¼ŒJava çš„çº¿ç¨‹åˆ›å»ºå’Œå¯åŠ¨éå¸¸ç®€å•ï¼Œä½†å¦‚æœé—®"),s("code",[t._v("ä¸€ä¸ªçº¿ç¨‹æ˜¯æ€ä¹ˆå¯åŠ¨èµ·æ¥çš„")]),t._v("å¾€å¾€å¹¶ä¸æ¸…æ¥šï¼Œç”šè‡³ä¸çŸ¥é“ä¸ºä»€ä¹ˆå¯åŠ¨æ—¶æ˜¯"),s("code",[t._v("è°ƒç”¨start()")]),t._v("ï¼Œè€Œä¸æ˜¯"),s("code",[t._v("è°ƒç”¨run()")]),t._v("æ–¹æ³•å‘¢ï¼Ÿ")]),t._v(" "),s("p",[s("strong",[t._v("é‚£ä¹ˆ")]),t._v("ï¼Œä¸ºäº†è®©å¤§å®¶æœ‰ä¸€ä¸ªæ›´ç›´è§‚çš„è®¤çŸ¥ï¼Œæˆ‘ä»¬å…ˆç«™åœ¨ä¸Šå¸è§†è§’ã€‚æŠŠè¿™æ®µ Java çš„çº¿ç¨‹ä»£ç ï¼Œåˆ° JDK æ–¹æ³•ä½¿ç”¨ï¼Œä»¥åŠ JVM çš„ç›¸åº”å¤„ç†è¿‡ç¨‹ï¼Œå±•ç¤ºç»™å¤§å®¶ï¼Œä»¥æ–¹ä¾¿æˆ‘ä»¬åç»­é€æ­¥åˆ†æã€‚")]),t._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"å›¾ 19-1 çº¿ç¨‹å¯åŠ¨åˆ†æ","data-src":"https://bugstack.cn/assets/images/2020/interview/interview-19-1.png",loading:"lazy"}})]),t._v(" "),s("p",[s("strong",[t._v("ä»¥ä¸Š")]),t._v("ï¼Œå°±æ˜¯ä¸€ä¸ªçº¿ç¨‹å¯åŠ¨çš„æ•´ä½“è¿‡ç¨‹åˆ†æï¼Œä¼šæ¶‰åŠåˆ°å¦‚ä¸‹çŸ¥è¯†ç‚¹ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("çº¿ç¨‹çš„å¯åŠ¨ä¼šæ¶‰åŠåˆ°æœ¬åœ°æ–¹æ³•ï¼ˆJNIï¼‰çš„è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯é‚£éƒ¨åˆ† C++ ç¼–å†™çš„ä»£ç ã€‚")]),t._v(" "),s("li",[t._v("JVM çš„å®ç°ä¸­ä¼šæœ‰ä¸åŒæ“ä½œç³»ç»Ÿå¯¹çº¿ç¨‹çš„ç»Ÿä¸€å¤„ç†ï¼Œæ¯”å¦‚ï¼šWinã€Linuxã€Unixã€‚")]),t._v(" "),s("li",[t._v("çº¿ç¨‹çš„å¯åŠ¨ä¼šæ¶‰åŠåˆ°çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€ï¼ˆRUNNABLEï¼‰ï¼Œä»¥åŠå”¤é†’æ“ä½œï¼Œæ‰€ä»¥æœ€ç»ˆä¼šæœ‰å›è°ƒæ“ä½œã€‚"),s("em",[t._v("ä¹Ÿå°±æ˜¯è°ƒç”¨æˆ‘ä»¬çš„ run() æ–¹æ³•")])])]),t._v(" "),s("p",[t._v("æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¼€å§‹é€æ­¥åˆ†ææ¯ä¸€æ­¥æºç çš„æ‰§è¡Œå†…å®¹ï¼Œä»è€Œäº†è§£çº¿ç¨‹å¯åŠ¨è¿‡ç¨‹ã€‚")]),t._v(" "),s("h2",{attrs:{id:"å››ã€çº¿ç¨‹å¯åŠ¨è¿‡ç¨‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å››ã€çº¿ç¨‹å¯åŠ¨è¿‡ç¨‹"}},[t._v("#")]),t._v(" å››ã€çº¿ç¨‹å¯åŠ¨è¿‡ç¨‹")]),t._v(" "),s("h3",{attrs:{id:"_1-thread-start-uml-å›¾"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-thread-start-uml-å›¾"}},[t._v("#")]),t._v(" 1. Thread start UML å›¾")]),t._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"å›¾ 19-2 Thread start UML å›¾","data-src":"https://bugstack.cn/assets/images/2020/interview/interview-19-2.png",loading:"lazy"}})]),t._v(" "),s("p",[t._v("å¦‚å›¾ 19-2 æ˜¯çº¿ç¨‹çš„å¯åŠ¨è¿‡ç¨‹æ—¶åºå›¾ï¼Œæ•´ä½“çš„é“¾è·¯è¾ƒé•¿ï¼Œä¼šæ¶‰åŠåˆ° JVM çš„æ“ä½œã€‚æ ¸å¿ƒæºç å¦‚ä¸‹ï¼š")]),t._v(" "),s("ol",[s("li",[s("code",[t._v("Thread.c")]),t._v("ï¼š"),s("a",{attrs:{href:"https://github.com/unofficial-openjdk/openjdk/blob/jdk/jdk/src/java.base/share/native/libjava/Thread.c",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/unofficial-openjdk/openjdk/blob/jdk/jdk/src/java.base/share/native/libjava/Thread.c"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("code",[t._v("jvm.cpp")]),t._v("ï¼š"),s("a",{attrs:{href:"https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/share/vm/prims/jvm.cpp",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/share/vm/prims/jvm.cpp"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("code",[t._v("thread.cpp")]),t._v("ï¼š"),s("a",{attrs:{href:"https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/share/vm/runtime/thread.cpp",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/share/vm/runtime/thread.cpp"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("code",[t._v("os.cpp")]),t._v("ï¼š"),s("a",{attrs:{href:"https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/share/vm/runtime/os.hpp",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/share/vm/runtime/os.hpp"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("code",[t._v("os_linux.cpp")]),t._v("ï¼š"),s("a",{attrs:{href:"https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/os/linux/vm/os_linux.cpp",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/os/linux/vm/os_linux.cpp"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("code",[t._v("os_windows.cpp")]),t._v("ï¼š"),s("a",{attrs:{href:"https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/os/windows/vm/os_windows.cpp",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/os/windows/vm/os_windows.cpp"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("code",[t._v("vmSymbols.hpp")]),t._v("ï¼š"),s("a",{attrs:{href:"https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/share/vm/classfile/vmSymbols.hpp",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/share/vm/classfile/vmSymbols.hpp"),s("OutboundLink")],1)])]),t._v(" "),s("h3",{attrs:{id:"_2-java-å±‚é¢-thread-å¯åŠ¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-java-å±‚é¢-thread-å¯åŠ¨"}},[t._v("#")]),t._v(" 2. Java å±‚é¢ Thread å¯åŠ¨")]),t._v(" "),s("h4",{attrs:{id:"_2-1-start-æ–¹æ³•"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-start-æ–¹æ³•"}},[t._v("#")]),t._v(" 2.1 start() æ–¹æ³•")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// todo")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// JDK æºç ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("synchronized")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("threadStatus "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IllegalThreadStateException")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    group"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" started "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("start0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        started "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("finally")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("started"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                group"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("threadStartFailed")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Throwable")]),t._v(" ignore"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br")])]),s("ul",[s("li",[t._v("çº¿ç¨‹å¯åŠ¨æ–¹æ³• "),s("code",[t._v("start()")]),t._v("ï¼Œåœ¨å®ƒçš„æ–¹æ³•è‹±æ–‡æ³¨é‡Šä¸­å·²ç»æŠŠæ ¸å¿ƒå†…å®¹æè¿°å‡ºæ¥ã€‚"),s("code",[t._v("Causes this thread to begin execution; the Java Virtual Machine calls the run method of this thread.")]),t._v(" è¿™æ®µè¯çš„æ„æ€æ˜¯ï¼šç”± JVM è°ƒç”¨æ­¤çº¿ç¨‹çš„ run æ–¹æ³•ï¼Œä½¿çº¿ç¨‹å¼€å§‹æ‰§è¡Œã€‚"),s("em",[t._v("å…¶å®è¿™å°±æ˜¯ä¸€ä¸ª JVM çš„å›è°ƒè¿‡ç¨‹ï¼Œä¸‹æ–‡æºç åˆ†æä¸­ä¼šè®²åˆ°")])]),t._v(" "),s("li",[t._v("å¦å¤– "),s("code",[t._v("start()")]),t._v(" æ˜¯ä¸€ä¸ª "),s("code",[t._v("synchronized")]),t._v(" æ–¹æ³•ï¼Œä½†ä¸ºäº†é¿å…å¤šæ¬¡è°ƒç”¨ï¼Œåœ¨æ–¹æ³•ä¸­ä¼šç”±çº¿ç¨‹çŠ¶æ€åˆ¤æ–­ã€‚"),s("code",[t._v("threadStatus != 0")]),t._v("ã€‚")]),t._v(" "),s("li",[s("code",[t._v("group.add(this)")]),t._v("ï¼Œæ˜¯æŠŠå½“å‰çº¿ç¨‹åŠ å…¥åˆ°çº¿ç¨‹ç»„ï¼ŒThreadGroupã€‚")]),t._v(" "),s("li",[s("code",[t._v("start0()")]),t._v("ï¼Œæ˜¯ä¸€ä¸ªæœ¬åœ°æ–¹æ³•ï¼Œé€šè¿‡ JNI æ–¹å¼è°ƒç”¨æ‰§è¡Œã€‚è¿™ä¸€æ­¥çš„æ“ä½œæ‰æ˜¯å¯åŠ¨çº¿ç¨‹çš„æ ¸å¿ƒæ­¥éª¤ã€‚")])]),t._v(" "),s("h4",{attrs:{id:"_2-2-start0-æœ¬åœ°æ–¹æ³•"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-start0-æœ¬åœ°æ–¹æ³•"}},[t._v("#")]),t._v(" 2.2 start0() æœ¬åœ°æ–¹æ³•")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æœ¬åœ°æ–¹æ³• start0")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("native")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("start0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ³¨å†Œæœ¬åœ°æ–¹æ³•")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Runnable")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Make sure registerNatives is the first thing <clinit> does. */")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("native")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerNatives")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerNatives")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("    \n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br")])]),s("ul",[s("li",[s("code",[t._v("start0()")]),t._v("ï¼Œæ˜¯ä¸€ä¸ªæœ¬åœ°æ–¹æ³•ï¼Œç”¨äºå¯åŠ¨çº¿ç¨‹ã€‚")]),t._v(" "),s("li",[s("code",[t._v("registerNatives()")]),t._v("ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯ç”¨äºæ³¨å†Œçº¿ç¨‹æ‰§è¡Œè¿‡ç¨‹ä¸­éœ€è¦çš„ä¸€äº›æœ¬åœ°æ–¹æ³•ï¼Œæ¯”å¦‚ï¼š"),s("code",[t._v("start0")]),t._v("ã€"),s("code",[t._v("isAlive")]),t._v("ã€"),s("code",[t._v("yield")]),t._v("ã€"),s("code",[t._v("sleep")]),t._v("ã€"),s("code",[t._v("interrupt0")]),t._v("ç­‰ã€‚")])]),t._v(" "),s("p",[s("strong",[t._v("registerNatives")]),t._v("ï¼Œæœ¬åœ°æ–¹æ³•å®šä¹‰åœ¨ "),s("code",[t._v("Thread.c")]),t._v(" ä¸­ï¼Œä»¥ä¸‹æ˜¯å®šä¹‰çš„æ ¸å¿ƒæºç ï¼š")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JNINativeMethod")]),t._v(" methods"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"start0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("           "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"()V"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JVM_StartThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stop0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"("')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("OBJ")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('")V"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JVM_StopThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"isAlive"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("          "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"()Z"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JVM_IsThreadAlive")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"suspend0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("         "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"()V"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JVM_SuspendThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"resume0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("          "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"()V"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JVM_ResumeThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"setPriority0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("     "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"(I)V"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JVM_SetThreadPriority")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"yield"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"()V"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JVM_Yield")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sleep"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"(J)V"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JVM_Sleep")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"currentThread"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"()"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("THD")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("     "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JVM_CurrentThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"interrupt0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"()V"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JVM_Interrupt")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"holdsLock"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"("')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("OBJ")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('")Z"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JVM_HoldsLock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"getThreads"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"()["')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("THD")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JVM_GetAllThreads")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dumpThreads"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"(["')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("THD")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('")[["')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("STE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JVM_DumpThreads")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"setNativeName"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"("')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("STR")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('")V"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JVM_SetNativeThreadName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br")])]),s("ul",[s("li",[s("strong",[t._v("æºç ")]),t._v("ï¼š"),s("a",{attrs:{href:"https://github.com/unofficial-openjdk/openjdk/blob/jdk/jdk/src/java.base/share/native/libjava/Thread.c",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/unofficial-openjdk/openjdk/blob/jdk/jdk/src/java.base/share/native/libjava/Thread.c"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("ä»å®šä¹‰ä¸­å¯ä»¥çœ‹åˆ°ï¼Œ"),s("code",[t._v("start0")]),t._v(" æ–¹æ³•ä¼šæ‰§è¡Œ "),s("code",[t._v("&JVM_StartThread")]),t._v(" æ–¹æ³•ï¼Œæœ€ç»ˆç”± JVM å±‚é¢å¯åŠ¨çº¿ç¨‹ã€‚")])]),t._v(" "),s("h3",{attrs:{id:"_3-jvm-åˆ›å»ºçº¿ç¨‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-jvm-åˆ›å»ºçº¿ç¨‹"}},[t._v("#")]),t._v(" 3. JVM åˆ›å»ºçº¿ç¨‹")]),t._v(" "),s("h4",{attrs:{id:"_3-1-jvm-startthread"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-jvm-startthread"}},[t._v("#")]),t._v(" 3.1 JVM_StartThread")]),t._v(" "),s("p",[s("strong",[t._v("æºç ")]),t._v("ï¼š"),s("a",{attrs:{href:"https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/share/vm/prims/jvm.cpp",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/share/vm/prims/jvm.cpp"),s("OutboundLink")],1)]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("JVM_ENTRY")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JVM_StartThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JNIEnv")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" jobject jthread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JVMWrapper")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"JVM_StartThread"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JavaThread")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("native_thread "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NULL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ›å»ºçº¿ç¨‹")]),t._v("\n  native_thread "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JavaThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("thread_entry"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sz"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¯åŠ¨çº¿ç¨‹")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("native_thread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JVM_END")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br")])]),s("ul",[s("li",[t._v("è¿™éƒ¨åˆ†ä»£ç æ¯”è¾ƒå¤šï¼Œä½†æ ¸å¿ƒå†…å®¹ä¸»è¦æ˜¯"),s("code",[t._v("åˆ›å»ºçº¿ç¨‹")]),t._v("å’Œ"),s("code",[t._v("å¯åŠ¨çº¿ç¨‹")]),t._v("ï¼Œå¦å¤– "),s("code",[t._v("&thread_entry")]),t._v(" ä¹Ÿæ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š")])]),t._v(" "),s("p",[s("strong",[t._v("thread_entryï¼Œçº¿ç¨‹å…¥å£")])]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("thread_entry")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JavaThread")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" thread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("TRAPS")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HandleMark")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("hm")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("THREAD")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Handle")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("obj")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("THREAD")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" thread"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("threadObj")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JavaValue")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("result")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("T_VOID")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JavaCalls")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("call_virtual")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                          obj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                          "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("KlassHandle")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("THREAD")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SystemDictionary")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread_klass")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                          vmSymbols"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("run_method_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                          vmSymbols"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("void_method_signature")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                          "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("THREAD")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br")])]),s("p",[s("strong",[t._v("é‡ç‚¹")]),t._v("ï¼Œåœ¨åˆ›å»ºçº¿ç¨‹å¼•å…¥è¿™ä¸ªçº¿ç¨‹å…¥å£çš„æ–¹æ³•æ—¶ï¼Œ"),s("code",[t._v("thread_entry")]),t._v(" ä¸­åŒ…æ‹¬äº† Java çš„å›è°ƒå‡½æ•° "),s("code",[t._v("JavaCalls::call_virtual")]),t._v("ã€‚è¿™ä¸ªå›è°ƒå‡½æ•°ä¼šç”± JVM è°ƒç”¨ã€‚")]),t._v(" "),s("p",[s("strong",[t._v("vmSymbols::run_method_name()")]),t._v("ï¼Œå°±æ˜¯é‚£ä¸ªè¢«å›è°ƒçš„æ–¹æ³•ï¼Œæºç å¦‚ä¸‹ï¼š")]),t._v(" "),s("p",[s("strong",[t._v("æºç ")]),t._v("ï¼š"),s("a",{attrs:{href:"https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/share/vm/classfile/vmSymbols.hpp",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/share/vm/classfile/vmSymbols.hpp"),s("OutboundLink")],1)]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[t._v("#define "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("VM_SYMBOLS_DO")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("template"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" do_alias"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("run_method_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"run"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("ul",[s("li",[t._v("è¿™ä¸ª "),s("code",[t._v("run")]),t._v(" å°±æ˜¯æˆ‘ä»¬çš„ Java ç¨‹åºä¸­ä¼šè¢«è°ƒç”¨çš„ run æ–¹æ³•ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ç»§ç»­æŒ‰ç…§ä»£ç æ‰§è¡Œé“¾è·¯ï¼Œå¯»æ‰¾åˆ°è¿™ä¸ªè¢«å›è°ƒçš„æ–¹æ³•åœ¨ä»€ä¹ˆæ—¶å€™è°ƒç”¨çš„ã€‚")])]),t._v(" "),s("h4",{attrs:{id:"_3-2-javathread"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-javathread"}},[t._v("#")]),t._v(" 3.2 JavaThread")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[t._v("native_thread "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JavaThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("thread_entry"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sz"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç»§ç»­çœ‹ "),s("code",[t._v("JavaThread")]),t._v(" çš„æºç æ‰§è¡Œå†…å®¹ã€‚")]),t._v(" "),s("p",[s("strong",[t._v("æºç ")]),t._v("ï¼š"),s("a",{attrs:{href:"https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/share/vm/runtime/thread.cpp",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/share/vm/runtime/thread.cpp"),s("OutboundLink")],1)]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JavaThread")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JavaThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ThreadFunction")]),t._v(" entry_point"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" size_t stack_sz"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n#"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("INCLUDE_ALL_GCS")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("_satb_mark_queue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("_satb_mark_queue_set"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("_dirty_card_queue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("_dirty_card_queue_set"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n#endif "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// INCLUDE_ALL_GCS")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TraceThreadEvents")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    tty"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("print_cr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"creating thread %p"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("initialize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  _jni_attach_state "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" _not_attaching_via_jni"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set_entry_point")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("entry_point"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Create the native thread itself.")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// %note runtime_23")]),t._v("\n  os"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ThreadType")]),t._v(" thr_type "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" os"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("java_thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  thr_type "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" entry_point "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("compiler_thread_entry "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" os"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("compiler_thread")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("os"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("java_thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  os"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("create_thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" thr_type"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" stack_sz"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br")])]),s("ul",[s("li",[s("code",[t._v("ThreadFunction entry_point")]),t._v("ï¼Œå°±æ˜¯æˆ‘ä»¬ä¸Šé¢çš„ "),s("code",[t._v("thread_entry")]),t._v(" æ–¹æ³•ã€‚")]),t._v(" "),s("li",[s("code",[t._v("size_t stack_sz")]),t._v("ï¼Œè¡¨ç¤ºè¿›ç¨‹ä¸­å·²æœ‰çš„çº¿ç¨‹ä¸ªæ•°ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("è¿™ä¸¤ä¸ªå‚æ•°")]),t._v("ï¼Œéƒ½ä¼šä¼ é€’ç»™ "),s("code",[t._v("os::create_thread")]),t._v(" æ–¹æ³•ï¼Œç”¨äºåˆ›å»ºçº¿ç¨‹ä½¿ç”¨ã€‚")])]),t._v(" "),s("h4",{attrs:{id:"_3-3-os-create-thread"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-os-create-thread"}},[t._v("#")]),t._v(" 3.3 os::create_thread")]),t._v(" "),s("p",[s("strong",[t._v("æºç ")]),t._v("ï¼š")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("os_linux.cpp")]),t._v("ï¼š"),s("a",{attrs:{href:"https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/os/linux/vm/os_linux.cpp",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/os/linux/vm/os_linux.cpp"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("code",[t._v("os_windows.cpp")]),t._v("ï¼š"),s("a",{attrs:{href:"https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/os/windows/vm/os_windows.cpp",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/os/windows/vm/os_windows.cpp"),s("OutboundLink")],1)])]),t._v(" "),s("p",[s("code",[t._v("ä¼—æ‰€å‘¨çŸ¥ï¼ŒJVM æ˜¯ä¸ªå•¥ï¼")]),t._v("ï¼Œæ‰€ä»¥å®ƒçš„ OS æœåŠ¡å®ç°ï¼ŒLiunx è¿˜æœ‰ Windows ç­‰ï¼Œéƒ½ä¼šå®ç°çº¿ç¨‹çš„åˆ›å»ºé€»è¾‘ã€‚"),s("em",[t._v("è¿™æœ‰ç‚¹åƒé€‚é…å™¨æ¨¡å¼")])]),t._v(" "),s("p",[s("strong",[t._v("os_linux -> os::create_thread")])]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[t._v("bool os"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("create_thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" thread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ThreadType")]),t._v(" thr_type"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" size_t stack_size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("assert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("thread"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("osthread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NULL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"caller responsible"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Allocate the OSThread object")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("OSThread")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" osthread "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("OSThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NULL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NULL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Initial state is ALLOCATED but not INITIALIZED")]),t._v("\n  osthread"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set_state")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ALLOCATED")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  pthread_t tid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" ret "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pthread_create")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("tid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("attr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" java_start"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" thread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br")])]),s("ul",[s("li",[s("code",[t._v("osthread->set_state(ALLOCATED)")]),t._v("ï¼Œåˆå§‹åŒ–å·²åˆ†é…çš„çŠ¶æ€ï¼Œä½†æ­¤æ—¶å¹¶æ²¡æœ‰åˆå§‹åŒ–ã€‚")]),t._v(" "),s("li",[s("code",[t._v("pthread_create")]),t._v("ï¼Œæ˜¯ç±»Unixæ“ä½œç³»ç»Ÿï¼ˆUnixã€Linuxã€Mac OS Xç­‰ï¼‰çš„åˆ›å»ºçº¿ç¨‹çš„å‡½æ•°ã€‚")]),t._v(" "),s("li",[s("code",[t._v("java_start")]),t._v("ï¼Œé‡ç‚¹å…³æ³¨ç±»ï¼Œæ˜¯å®é™…åˆ›å»ºçº¿ç¨‹çš„æ–¹æ³•ã€‚")])]),t._v(" "),s("h4",{attrs:{id:"_3-4-java-start"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-java-start"}},[t._v("#")]),t._v(" 3.4 java_start")]),t._v(" "),s("p",[s("strong",[t._v("æºç ")]),t._v("ï¼š"),s("a",{attrs:{href:"https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/os/linux/vm/os_linux.cpp",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/os/linux/vm/os_linux.cpp"),s("OutboundLink")],1)]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("java_start")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("thread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// çº¿ç¨‹ID")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" pid "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" os"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("current_process_id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¾ç½®çº¿ç¨‹")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ThreadLocalStorage")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set_thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("thread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¾ç½®çº¿ç¨‹çŠ¶æ€ï¼šINITIALIZED åˆå§‹åŒ–å®Œæˆ")]),t._v("\n  osthread"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set_state")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("INITIALIZED")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å”¤é†’æ‰€æœ‰çº¿ç¨‹")]),t._v("\n  sync"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("notify_all")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¾ªç¯ï¼Œåˆå§‹åŒ–çŠ¶æ€ï¼Œåˆ™ä¸€è‡´ç­‰å¾… wait")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("osthread"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_state")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("INITIALIZED")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    sync"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("wait")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Mutex")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("_no_safepoint_check_flag")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç­‰å¾…å”¤é†’åï¼Œæ‰§è¡Œ run æ–¹æ³•")]),t._v("\n  thread"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br")])]),s("ul",[s("li",[t._v("JVM è®¾ç½®çº¿ç¨‹çŠ¶æ€ï¼ŒINITIALIZED åˆå§‹åŒ–å®Œæˆã€‚")]),t._v(" "),s("li",[s("code",[t._v("sync->notify_all()")]),t._v("ï¼Œå”¤é†’æ‰€æœ‰çº¿ç¨‹ã€‚")]),t._v(" "),s("li",[s("code",[t._v("osthread->get_state() == INITIALIZED")]),t._v("ï¼Œwhile å¾ªç¯ç­‰å¾…")]),t._v(" "),s("li",[s("code",[t._v("thread->run()")]),t._v("ï¼Œæ˜¯ç­‰å¾…çº¿ç¨‹å”¤é†’åï¼Œä¹Ÿå°±æ˜¯çŠ¶æ€å˜æ›´åï¼Œæ‰èƒ½æ‰§è¡Œåˆ°ã€‚"),s("em",[t._v("è¿™åœ¨æˆ‘ä»¬çš„çº¿ç¨‹æ‰§è¡ŒUMLå›¾ä¸­ï¼Œä¹Ÿæœ‰æ‰€ä½“ç°")])])]),t._v(" "),s("h3",{attrs:{id:"_4-jvm-å¯åŠ¨çº¿ç¨‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-jvm-å¯åŠ¨çº¿ç¨‹"}},[t._v("#")]),t._v(" 4. JVM å¯åŠ¨çº¿ç¨‹")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("JVM_ENTRY")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JVM_StartThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JNIEnv")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" jobject jthread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JVMWrapper")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"JVM_StartThread"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JavaThread")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("native_thread "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NULL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ›å»ºçº¿ç¨‹")]),t._v("\n  native_thread "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JavaThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("thread_entry"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sz"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¯åŠ¨çº¿ç¨‹")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("native_thread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JVM_END")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br")])]),s("ul",[s("li",[s("code",[t._v("JVM_StartThread")]),t._v(" ä¸­æœ‰ä¸¤æ­¥ï¼Œåˆ›å»ºï¼ˆ"),s("code",[t._v("new JavaThread")]),t._v("ï¼‰ã€å¯åŠ¨ï¼ˆ"),s("code",[t._v("Thread::start")]),t._v("ï¼‰ã€‚åˆ›å»ºçš„è¿‡ç¨‹èŠå®Œäº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬èŠå¯åŠ¨ã€‚")])]),t._v(" "),s("h4",{attrs:{id:"_4-1-thread-start"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-thread-start"}},[t._v("#")]),t._v(" 4.1 Thread::start")]),t._v(" "),s("p",[s("strong",[t._v("æºç ")]),t._v("ï¼š"),s("a",{attrs:{href:"https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/share/vm/runtime/thread.cpp",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/share/vm/runtime/thread.cpp"),s("OutboundLink")],1)]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" thread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("trace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"start"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" thread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DisableStartThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("thread"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("is_Java_thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      java_lang_Thread"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set_thread_status")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JavaThread")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("thread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("threadObj")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                                          java_lang_Thread"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("RUNNABLE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¸åŒçš„ OS ä¼šæœ‰ä¸åŒçš„å¯åŠ¨ä»£ç é€»è¾‘")]),t._v("\n    os"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("start_thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("thread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br")])]),s("ul",[s("li",[t._v("å¦‚æœæ²¡æœ‰ç¦ç”¨çº¿ç¨‹ "),s("code",[t._v("DisableStartThread")]),t._v(" å¹¶ä¸”æ˜¯ Java çº¿ç¨‹ "),s("code",[t._v("thread->is_Java_thread()")]),t._v("ï¼Œé‚£ä¹ˆè®¾ç½®çº¿ç¨‹çŠ¶æ€ä¸º "),s("code",[t._v("RUNNABLE")]),t._v("ã€‚")]),t._v(" "),s("li",[s("code",[t._v("os::start_thread(thread)")]),t._v("ï¼Œè°ƒç”¨çº¿ç¨‹å¯åŠ¨æ–¹æ³•ã€‚"),s("em",[t._v("ä¸åŒçš„ OS ä¼šæœ‰ä¸åŒçš„å¯åŠ¨ä»£ç é€»è¾‘")])])]),t._v(" "),s("h4",{attrs:{id:"_4-2-os-start-thread-thread"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-os-start-thread-thread"}},[t._v("#")]),t._v(" 4.2 os::start_thread(thread)")]),t._v(" "),s("p",[s("strong",[t._v("æºç ")]),t._v("ï¼š"),s("a",{attrs:{href:"https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/share/vm/runtime/os.hpp",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/share/vm/runtime/os.hpp"),s("OutboundLink")],1)]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" os"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("start_thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" thread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// guard suspend/resume")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MutexLockerEx")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ml")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("thread"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SR_lock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Mutex")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("_no_safepoint_check_flag")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("OSThread")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" osthread "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" thread"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("osthread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  osthread"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set_state")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("RUNNABLE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pd_start_thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("thread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])]),s("ul",[s("li",[s("code",[t._v("osthread->set_state(RUNNABLE)")]),t._v("ï¼Œè®¾ç½®çº¿ç¨‹çŠ¶æ€ "),s("code",[t._v("RUNNABLE")])]),t._v(" "),s("li",[s("code",[t._v("pd_start_thread(thread)")]),t._v("ï¼Œå¯åŠ¨çº¿ç¨‹ï¼Œè¿™ä¸ªå°±ç”±å„ä¸ª OS å®ç°ç±»ï¼Œå®ç°å„è‡ªç³»ç»Ÿçš„å¯åŠ¨æ–¹æ³•äº†ã€‚"),s("em",[t._v("æ¯”å¦‚ï¼Œwindowsç³»ç»Ÿå’ŒLinuxç³»ç»Ÿçš„ä»£ç æ˜¯å®Œå…¨ä¸åŒçš„ã€‚")])])]),t._v(" "),s("h4",{attrs:{id:"_4-3-pd-start-thread-thread"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-pd-start-thread-thread"}},[t._v("#")]),t._v(" 4.3 pd_start_thread(thread)")]),t._v(" "),s("p",[s("strong",[t._v("æºç ")]),t._v("ï¼š"),s("a",{attrs:{href:"https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/os/linux/vm/os_linux.cpp",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/os/linux/vm/os_linux.cpp"),s("OutboundLink")],1)]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" os"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pd_start_thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" thread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("OSThread")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" osthread "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" thread"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("osthread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("assert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("osthread"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_state")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("INITIALIZED")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"just checking"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Monitor")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" sync_with_child "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" osthread"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("startThread_lock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MutexLockerEx")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ml")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sync_with_child"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Mutex")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("_no_safepoint_check_flag")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  sync_with_child"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("notify")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])]),s("ul",[s("li",[t._v("è¿™éƒ¨åˆ†ä»£ç  "),s("code",[t._v("notify()")]),t._v(" æœ€å…³é”®ï¼Œå®ƒå¯ä»¥å”¤é†’çº¿ç¨‹ã€‚")]),t._v(" "),s("li",[t._v("çº¿ç¨‹å”¤é†’åï¼Œ"),s("code",[t._v("3.4 ä¸­çš„ thread->run();")]),t._v(" å°±å¯ä»¥ç»§ç»­æ‰§è¡Œäº†ã€‚")])]),t._v(" "),s("h3",{attrs:{id:"_5-jvm-çº¿ç¨‹å›è°ƒ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-jvm-çº¿ç¨‹å›è°ƒ"}},[t._v("#")]),t._v(" 5. JVM çº¿ç¨‹å›è°ƒ")]),t._v(" "),s("h4",{attrs:{id:"_5-1-thread-run-javathread-run"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-thread-run-javathread-run"}},[t._v("#")]),t._v(" 5.1 thread->run()[JavaThread::run()]")]),t._v(" "),s("p",[s("strong",[t._v("æºç ")]),t._v("ï¼š"),s("a",{attrs:{href:"https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/share/vm/runtime/thread.cpp",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/share/vm/runtime/thread.cpp"),s("OutboundLink")],1)]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// The first routine called by a new Java thread")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JavaThread")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ... åˆå§‹åŒ–çº¿ç¨‹æ“ä½œ")]),t._v("\n  \n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("thread_main_inner")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])]),s("ul",[s("li",[t._v("os_linux.cpp ç±»ä¸­çš„ java_start é‡Œçš„ thread->run()ï¼Œæœ€ç»ˆè°ƒç”¨çš„å°±æ˜¯ thread.cpp çš„ JavaThread::run() æ–¹æ³•ã€‚")]),t._v(" "),s("li",[t._v("è¿™éƒ¨åˆ†è¿˜éœ€è¦ç»§ç»­å¾€ä¸‹çœ‹ï¼Œ"),s("code",[t._v("thread_main_inner();")]),t._v(" æ–¹æ³•ã€‚")])]),t._v(" "),s("h4",{attrs:{id:"_5-2-thread-main-inner"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-thread-main-inner"}},[t._v("#")]),t._v(" 5.2 thread_main_inner")]),t._v(" "),s("p",[s("strong",[t._v("æºç ")]),t._v("ï¼š"),s("a",{attrs:{href:"https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/share/vm/runtime/thread.cpp",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/JetBrains/jdk8u_hotspot/blob/master/src/share/vm/runtime/thread.cpp"),s("OutboundLink")],1)]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JavaThread")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("thread_main_inner")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("has_pending_exception")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("java_lang_Thread"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("is_stillborn")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("threadObj")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ResourceMark")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set_native_thread_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_thread_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HandleMark")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("hm")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("entry_point")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("DTRACE_THREAD_PROBE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("stop"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("exit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  delete "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br")])]),s("ul",[s("li",[t._v("è¿™é‡Œæœ‰ä½ ç†Ÿæ‚‰çš„è®¾ç½®çš„çº¿ç¨‹åç§°ï¼Œ"),s("code",[t._v("this->set_native_thread_name(this->get_thread_name())")]),t._v("ã€‚")]),t._v(" "),s("li",[s("code",[t._v("this->entry_point()")]),t._v("ï¼Œå®é™…è°ƒç”¨çš„å°±æ˜¯  3.1 ä¸­çš„ thread_entry æ–¹æ³•ã€‚")]),t._v(" "),s("li",[s("code",[t._v("thread_entry")]),t._v("ï¼Œæ–¹æ³•æœ€ç»ˆä¼šè°ƒç”¨åˆ° "),s("code",[t._v("JavaCalls::call_virtual")]),t._v(" é‡Œçš„"),s("code",[t._v("vmSymbols::run_method_name()")]),t._v("ã€‚ä¹Ÿå°±æ˜¯ run() æ–¹æ³•ï¼Œè‡³æ­¤çº¿ç¨‹å¯åŠ¨å®Œæˆã€‚"),s("em",[t._v("ç»ˆäºä¸²å›æ¥äº†ï¼")])])]),t._v(" "),s("h2",{attrs:{id:"äº”ã€æ€»ç»“"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#äº”ã€æ€»ç»“"}},[t._v("#")]),t._v(" äº”ã€æ€»ç»“")]),t._v(" "),s("ul",[s("li",[t._v("çº¿ç¨‹çš„å¯åŠ¨è¿‡ç¨‹æ¶‰åŠåˆ°äº† JVM çš„å‚ä¸ï¼Œæ‰€ä»¥å¦‚æœæ²¡æœ‰è®¤çœŸäº†è§£è¿‡ï¼Œç¡®å®å¾ˆéš¾ä»ä¸€ä¸ªæœ¬åœ°æ–¹æ³•äº†è§£çš„å¦‚æ­¤é€å½»ã€‚")]),t._v(" "),s("li",[t._v("æ•´ä¸ªæºç åˆ†æå¯ä»¥ç»“åˆç€ä»£ç è°ƒç”¨UMLæ—¶åºå›¾è¿›è¡Œå­¦ä¹ ï¼ŒåŸºæœ¬æ ¸å¿ƒè¿‡ç¨‹åŒ…æ‹¬ï¼š"),s("code",[t._v("Java åˆ›å»ºçº¿ç¨‹å’Œå¯åŠ¨")]),t._v("ã€"),s("code",[t._v("è°ƒç”¨æœ¬åœ°æ–¹æ³• start0()")]),t._v("ã€"),s("code",[t._v("JVM ä¸­ JVM_StartThread çš„åˆ›å»ºå’Œå¯åŠ¨")]),t._v("ã€"),s("code",[t._v("è®¾ç½®çº¿ç¨‹çŠ¶æ€ç­‰å¾…è¢«å”¤é†’")]),t._v("ã€"),s("code",[t._v("æ ¹æ®ä¸åŒçš„OSå¯åŠ¨çº¿ç¨‹å¹¶å”¤é†’")]),t._v("ã€"),s("code",[t._v("æœ€åå›è°ƒ run() æ–¹æ³•å¯åŠ¨ Java çº¿ç¨‹")]),t._v("ã€‚")]),t._v(" "),s("li",[t._v("æœ‰æ—¶å€™å¯èƒ½åªæ˜¯ä¸€æ­¥å¾ˆç®€å•çš„æ–¹æ³•ï¼Œä¹Ÿä¼šæœ‰å®ƒçš„æ·±å…¥ä¹‹å¤„ï¼Œå½“çœŸçš„æ‡‚äº†ä»¥åï¼Œå°±ä¸ç”¨æ­»è®°ç¡¬èƒŒã€‚"),s("em",[t._v("å¦‚æœéœ€è¦è·å¾—ä»¥ä¸Šé«˜æ¸…å¤§å›¾ï¼Œå¯ä»¥æ·»åŠ å°å‚…å“¥å¾®ä¿¡("),s("code",[t._v("fustack")]),t._v(")ï¼Œå¤‡æ³¨ï¼šThreadå¤§å›¾")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);